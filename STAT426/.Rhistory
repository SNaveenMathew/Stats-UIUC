install.packages('faraway')
library(faraway)
data(death)
head(death)
horseshoe <- read.table("horseshoe.txt", header = T)
model <- glm(satell ~ color + spine + width + weight, family = poisson, data = horseshoe)
summary(model)
pchisq(551.85, df = 168)
model$deviance
pchisq(model$deviance, model$df.residual)
vcov(model)
model0 <- glm(satell ~ color + weight, family = poisson, data = horseshoe)
summary(model0)
anova(model0, model, test = "Chisq")
anova(model0, model, test = "Chisq")
?anova
drop1(model, test = "Chisq")
drop1(model, test = "Chisq")
drop1(model, test = "Rao")
drop1(model0, model, test = "Rao")
anova(model0, model, test = "Rao")
drop1(model, test = "Rao")
confint(model)
plot(residuals(model, type = "response"))
plot(residuals(model, type = "response"))
plot(residuals(model, type = "pearson"))
(X.2 <- sum(residuals(model, type = "pearson")^2))
model$deviance
plot(residuals(model, type = "pearson"))
plot(residuals(model, type = "deviance"))
(X.2 <- sum(residuals(model, type = "deviance")^2))
model$deviance
gm <- data.table::fread("https://raw.githubusercontent.com/cran/gapminder/master/inst/extdata/gapminder.tsv")
head(gm)
sum(is.na(gm$pop))
colnames(gm)[3] <- "Year"
df <- gm[gm$Year == year]
df[, "pop" := as.double(pop), ][, "totpop" := sum(pop, na.rm = T), continent]
year = 1987
colnames(gm)[3] <- "Year"
df <- gm[gm$Year == year]
df[, "pop" := as.double(pop), ][, "totpop" := sum(pop, na.rm = T), continent]
sum(is.na(df$totpop))
df <- gm[gm$Year == year]
df[, "pop" := as.double(pop), ][, "totpop" := sum(pop), continent]
sum(is.na(df$totpop))
df <- df[, .SD[1], continent]
df <- df[, c("totpop", "continent")]
df[, "totpop" := totpop, ]
setorder(df, -totpop)
data.table::setorder(df, -totpop)
df
length(unique(gm$continent))
gm1 <- data.frame(gm)
library(dplyr)
gm1 %>% group_by(continent) %>% summarize(totpop = sum(pop[Year == year]))
sapply(df, class)
year = 1967
gm1 %>% group_by(continent) %>% summarize(totpop = sum(pop[Year == year]))
gm1 %>% group_by(continent) %>% summarize(totpop = sum(pop[Year == year])) %>% order_by(-totpop)
gm2 <- gm1 %>% group_by(continent) %>% summarize(totpop = sum(pop[Year == year]))
gm2 %>% order_by(-totpop)
gm2 %>% order_by(totpop)
gm2[order(-gm2$totpop),]
year <- 1992
gm2 <- gm1 %>% group_by(continent) %>% summarize(totpop = sum(pop[Year == year]))
gm2[order(-gm2$totpop),]
